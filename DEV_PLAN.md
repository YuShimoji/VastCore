# Vastcore 開発計画 & ドキュメント

## 1. プロジェクトコンセプト

このプロジェクトの目的は、ゲームプレイの舞台（ダンジョン）を作ることではなく、**広大な景観に映える、ユニークで巨大な人工構造物をプロシージャルに生成する**ことである。

生成される構造物は、ミニマルでありながら、単体で芸術的価値を持つような、印象的な景観の一部となることを目指す。初期の参考画像に見られるような、多様な幾何学形状の組み合わせによって生まれる、ユニークで複雑な形状の自動生成が中核となる。

---

## 2. 6段階開発計画（2025年1月更新）

### Phase 1: 基本関係性システム
- 構造物間の9種類の関係性（OnTop, Inside, OnSide, Around等）
- 自動位置計算とBounds対応配置
- RelationshipTabによるUI管理

### Phase 2: 形状制御システム
- 高度な形状制御パラメータ（ツイスト、テーパー、ベンド等）
- Boolean演算制御（面選択、体積閾値、減衰制御）
- 高度加工システム（表面処理、エッジ処理、風化効果）
- 8つの記念碑タイプ実装
- 実装完了日: 2024-12-XX

### Phase 3: Deformシステム統合 
**開発方針**: Unity Asset Store パッケージ導入前にCursor webで設計・準備作業を実施
- **技術調査**: Deformパッケージ（20種類以上のDeformer）の統合方式調査
- **システム設計**: 変形マスクシステム・アニメーション変形の設計
- **コード準備**: 統合用ベースクラス・インターフェースの実装
- **予定工数**: 3-5レスポンス（設計） + Unity実装テスト

### Phase 4: パーティクル的配置システム
- 8種類の配置パターン（Linear, Circular, Spiral, Grid, Random, Fractal, Voronoi, Organic）
- 衝突回避システム（最小距離制御）
- ハイトマップ地形適合システム
- 回転・スケール制御とプリセット対応
- 実装完了日: 2024-12-XX

### Phase 5: 高度合成システム
**開発方針**: Unity エディタなしでの設計・実装が可能
- **モデル合成**: 複数メッシュの統合・ブレンド機能
- **LOD生成**: 距離に応じた詳細度制御システム
- **メッシュ最適化**: パフォーマンス向上のための最適化
- **ライティング焼き込み**: 静的ライティングの事前計算
- **体積ブレンド**: 距離フィールド合成の高度化
- **予定工数**: 5-8レスポンス

### Phase 6: ランダム制御システム
- **制御されたランダム性**: ControlledRandom, BlendShapeRandomの強化
- **ランダムシード管理**: 再現可能なランダム生成システム
- **パラメータ制約**: 高度な制約システムの実装
- **ランダムプリセット**: プリセット管理の拡張
- **予定工数**: 4-6レスポンス

---

## 3. Cursor Web 開発計画

### 3.1. 短期目標（1-3回の作業セッション）

#### **Phase 3 技術調査・設計**
- **Deformパッケージ調査**: Unity Asset Storeでの仕様・API調査
- **統合方式設計**: 既存Structure Generatorとの統合方法策定
- **インターフェース設計**: DeformerタブUI・パラメータ制御の設計

#### **既存コード最適化**
- **AdvancedPlayerController**: エネルギーシステムの効率化
- **MeshGenerator**: 大規模地形生成の最適化
- **Structure Generator**: メモリ使用量削減・処理速度向上

#### **開発文書整理**
- **設計文書統合**: 分散した仕様書の統合・更新
- **API仕様書作成**: 主要クラス・メソッドの詳細仕様
- **テスト仕様書**: 機能テスト項目の体系化

### 3.2. 中期目標（4-10回の作業セッション）

#### **Phase 5 高度合成システム実装**
```csharp
// 実装予定クラス構造
public class AdvancedCompositionSystem
{
    // モデル合成
    public CompositionResult ComposeModels(List<GameObject> sources);
    
    // LOD生成
    public LODGroup GenerateLOD(GameObject source, int lodLevels);
    
    // メッシュ最適化
    public Mesh OptimizeMesh(Mesh source, OptimizationLevel level);
    
    // ライティング焼き込み
    public Texture2D BakeLighting(GameObject target, BakeSettings settings);
}
```

#### **新機能企画・設計**
- **次世代プレイヤー機能**: 壁走り、重力操作、時間制御等
- **環境インタラクション**: 破壊可能オブジェクト、物理パズル等
- **プロシージャル音響**: 空間に応じた音響効果自動生成

#### **テストシステム拡充**
- **自動テスト拡張**: 全機能の自動テスト対応
- **パフォーマンステスト**: 負荷テスト・最適化指標
- **回帰テスト**: 既存機能の安定性確保

### 3.3. 長期目標（10回以上の作業セッション）

#### **Phase 6 ランダム制御システム完成**
- **高度ランダム制御**: シード管理・再現性確保
- **プリセットシステム**: 豊富なランダム化プリセット
- **リアルタイム制御**: パラメータのライブ調整

#### **システム統合・最適化**
- **全フェーズ統合**: Phase 1-6の完全統合
- **パフォーマンス最適化**: 大規模シーンでの動作保証
- **UI/UX改善**: 使いやすさの向上

#### **拡張機能開発**
- **VR/AR対応**: 新プラットフォーム対応
- **マルチプレイヤー**: 協調的構造物生成
- **AI統合**: 機械学習による自動生成

---

## 4. 開発ツール概要

### 4.1. Structure Generator (`StructureGeneratorWindow.cs`)

構造物を生成・加工するためのメインツール。7つのタブで構成。

#### **🏗️ 生成タブ (Generation)**
| タブ | 機能 | 状況 | Cursor Web対応 |
|------|------|------|----------------|
| **Basic** | 基本形状生成 |
| **Advanced** | 高度構造物生成 |
| **Distribution** | 配置・分布生成 |

#### **✏️ 編集タブ (Editing)**
| タブ | 機能 | 状況 | Cursor Web対応 |
|------|------|------|----------------|
| **Operations** | CSG演算・編集操作 | 
| **Composition** | 形状合成・編集 |
| **Random** | ランダム編集 | 

#### **⚙️ 設定タブ (Settings)**
| タブ | 機能 | 状況 | Cursor Web対応 |
|------|------|------|----------------|
| **Relationships** | 関係性管理・設定 

### 4.2. プレイヤーシステム

#### **高度移動システム** (完成済み)
- **AdvancedPlayerController**: グライド、ドリームフライト、グラインド
- **TranslocationSphere**: ワープ移動・軌道予測
- **統合テストシーン**: 動作確認用シーン

#### **地形生成システム** (完成済み)
- **MeshGenerator**: 3種類地形・5種類ノイズ
- **SimpleTestManager**: 自動テスト・パラメータ制御



## 6. 開発優先度・スケジュール

### 6.1. 最優先項目

#### **短期（次回1-3セッション）**
1. **Phase 3技術調査**: Deformシステム統合準備
2. **コード最適化**: パフォーマンス・保守性向上
3. **ドキュメント整理**: 設計文書統合・API仕様書

#### **中期（4-10セッション）**
1. **Phase 5実装**: 高度合成システム
2. **新機能設計**: 次世代プレイヤー機能企画
3. **テストシステム**: 自動テスト機能拡充

#### **長期（10セッション以上）**
1. **Phase 6完成**: ランダム制御システム
2. **全システム統合**: 最適化・安定化
3. **拡張機能**: VR/AR対応・AI統合

### 6.2. 成功指標

#### **短期成功指標**
- [ ] Deformシステム統合設計完了
- [ ] 既存コードの20%以上最適化
- [ ] 統一API仕様書作成

#### **中期成功指標**
- [ ] Phase 5完全実装・テスト完了
- [ ] 新機能プロトタイプ3つ以上
- [ ] 自動テスト95%カバレッジ達成

#### **長期成功指標**
- [ ] 全Phase（1-6）完成・統合済み
- [ ] 商用レベル品質達成
- [ ] 拡張プラットフォーム対応

---

## 7. ドキュメント

### 7.1. 開発管理文書
- `DEV_LOG.md`: 開発作業の詳細ログ
- `FUNCTION_TEST_STATUS.md`: 機能テスト状況表
- `CURSOR_WEB_DEVELOPMENT_GUIDE.md`: Cursor web開発ガイド

### 7.2. 設計文書
- `ADVANCED_STRUCTURE_DESIGN_DOCUMENT.md`: 6段階開発計画の詳細設計
- `REFACTORING_HANDOVER_DOCUMENT.md`: リファクタリング記録
- `CSG_INTEGRATION_LOG.md`: CSGシステム統合記録

### 7.3. Unity プロジェクト文書
- `README.md`: プロジェクト概要・ゲームデザイン
- `RANDOMCONTROL_UI_DESIGN.md`: UI設計仕様

---

## 8. 技術スタック・依存関係

### 8.1. 主要技術
- **Unity 2022.3 LTS**: ゲームエンジン
- **ProBuilder**: 3D形状生成・編集
- **pb_CSG**: Boolean演算ライブラリ
- **Deform (予定)**: 高度メッシュ変形

### 8.2. 開発環境
- **Cursor Web**: C#開発・設計・ドキュメント
- **Unity Editor**: 実装テスト・デバッグ
- **Git**: バージョン管理（GitHub連携予定）

---

**最終更新**: 2025年1月  
**開発体制**: Cursor Web + Unity エディタのハイブリッド開発  
**次回作業**: Phase 3 技術調査・既存コード最適化 