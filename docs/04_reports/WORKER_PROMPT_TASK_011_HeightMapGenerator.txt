<instruction>
あなたは分散開発チームの Worker です。割り当てられた 1 タスクだけを完遂し、証跡を残してください。
</instruction>

<context>
<mission_log>
作業開始時に `.cursor/MISSION_LOG.md` を読み込み、現在のフェーズと進捗を確認してください。
作業完了時に MISSION_LOG.md を更新し、進捗を記録してください。
</mission_log>

<ssot_reference>
Phase 0: 参照と整備
- SSOT: .shared-workflows/docs/Windsurf_AI_Collab_Rules_latest.md（無ければ docs/ 配下を参照し、必ず `ensure-ssot.js` で取得を試す）
- 進捗: docs/HANDOVER.md
- チケット: docs/tasks/TASK_011_HeightMapGenerator_Determinism_Channel_UV.md
</ssot_reference>

<preconditions>
Phase 1: 前提の固定
- Tier: 2
- Branch: feature/TASK_011_heightmap-generator-determinism
- Report Target: docs/inbox/REPORT_TASK_011_HeightMapGenerator_Determinism_Channel_UV.md
- GitHubAutoApprove: docs/HANDOVER.md の記述を参照（未記載なら push 禁止）
</preconditions>

<boundaries>
Phase 2: 境界
- Focus Area:
  - Assets/MapGenerator/Scripts/HeightMapGenerator.cs
  - Assets/MapGenerator/Scripts/TerrainGenerator.cs
  - Assets/Scripts/Generation/TerrainGenerationProfile.cs（必要があれば）
  - Assets/Tests/EditMode/*（必要最小限）
- Forbidden Area:
  - .shared-workflows/
  - ProjectSettings/, Packages/（必要が出たら停止）
  - 新規依存追加（禁止）
- DoD:
  - [ ] チャンネル/UV/反転が HeightMap モードで反映される
  - [ ] Noise モードで Seed の再現性が担保される
  - [ ] NoiseAndHeightMap モードが壊れていない
  - [ ] 変更点・検証手順を docs/inbox/REPORT_TASK_011_HeightMapGenerator_Determinism_Channel_UV.md に記録
  - [ ] 自動テストは最小（壊れやすい箇所だけ）
</boundaries>
</context>

<workflow>
<phase name="Phase 0: 参照と整備">
<step>
1. `.cursor/MISSION_LOG.md` を読む。
2. チケットを存在確認してから読む。
3. 現状実装の “反映されていない入力” を洗い出す（チャンネル/UV/反転/Seed）。
</step>
</phase>

<phase name="Phase 1: 前提の固定">
<step>
1. `git status -sb` を確認。
2. `git switch feature/TASK_011_heightmap-generator-determinism`（無ければ作成）。
3. MISSION_LOG.md を更新（Phase 1 完了）。
</step>
</phase>

<phase name="Phase 2: 境界確認">
<step>
1. Focus/Forbidden/DoD を確認。
2. 触るファイルの存在確認。
3. MISSION_LOG.md を更新（Phase 2 完了）。
</step>
</phase>

<phase name="Phase 3: 実装">
<step>
1. HeightMap サンプルにチャンネル/UV/反転を反映（最小）。
2. Noise 生成に Seed を反映（最小、Offset派生など）。
3. 可能なら EditMode テストを 1 本だけ追加/更新。
4. MISSION_LOG.md を更新（Phase 3 完了）。
</step>
</phase>

<phase name="Phase 4: 納品 & 検証">
<step>
1. docs/inbox/REPORT_TASK_011_HeightMapGenerator_Determinism_Channel_UV.md を作成し、Changes/Verification/Risk を記録。
2. `node .shared-workflows/scripts/report-validator.js docs/inbox/REPORT_TASK_011_HeightMapGenerator_Determinism_Channel_UV.md` を実行し、結果を記載。
3. commit（必要なら push。GitHubAutoApprove に従う）。
4. MISSION_LOG.md を更新（Phase 4 完了）。
</step>
</phase>

<phase name="Phase 5: チャット出力">
<step>
完了時: `Done: docs/tasks/TASK_011_HeightMapGenerator_Determinism_Channel_UV.md. Report: docs/inbox/REPORT_TASK_011_HeightMapGenerator_Determinism_Channel_UV.md.`
</step>
</phase>
</workflow>

<stop_conditions>
停止条件:
- Forbidden Area に触れないと解決できない
- 依存追加が必要
- 破壊的・復旧困難操作が必要
</stop_conditions>


