# VastCore 作業最適化ガイドライン

## 基本原則

### 1. 段階的アプローチ
- **小さな変更**: 一度に大きな変更を行わない
- **頻繁なコミット**: 動作する状態を常に保つ
- **テスト駆動**: 変更前に必ずテストを書く

### 2. コード品質基準
- **コンパイルエラー0**: エラーがある状態でコミットしない
- **警告最小化**: 警告も可能な限り解決
- **明確な責任**: 各クラスは単一の責任を持つ

### 3. ファイル構造
```
Assets/
├── Scripts/          # 本番コードのみ
│   ├── Core/        # コアシステム
│   ├── Player/      # プレイヤー関連
│   ├── Terrain/     # 地形生成
│   └── UI/          # ユーザーインターフェース
├── Tests/           # テストコード
│   ├── Editor/      # Editorテスト
│   └── Runtime/     # ランタイムテスト
└── Documentation/   # ドキュメント
    ├── Active/      # 現在有効なドキュメント
    └── Archive/     # アーカイブ済み

```

## 作業フロー

### 1. 新機能追加時
1. 仕様書を作成
2. テストケースを定義
3. 最小実装を作成
4. テストを実行
5. リファクタリング
6. ドキュメント更新

### 2. バグ修正時
1. バグを再現するテストを作成
2. 最小限の修正を実施
3. テストが通ることを確認
4. 影響範囲をチェック
5. コミット

### 3. リファクタリング時
1. 現在の動作をテストで保証
2. 小さな単位で変更
3. 各ステップでテスト実行
4. パフォーマンス測定
5. ドキュメント更新

## コミット規則

### コミットメッセージ形式
```
[タイプ] 簡潔な説明

- 詳細な変更内容
- 影響範囲
- テスト結果
```

### タイプ
- `feat`: 新機能
- `fix`: バグ修正
- `refactor`: リファクタリング
- `docs`: ドキュメント
- `test`: テスト
- `cleanup`: 整理・削除

## エラー対処法

### コンパイルエラー
1. エラーログを`Error[日付]`ファイルに保存
2. エラー数が多い場合は、ファイル単位で無効化
3. 依存関係を確認して順次修正

### ランタイムエラー
1. スタックトレースを記録
2. 最小再現コードを作成
3. ユニットテストを追加
4. 修正後、統合テスト実施

## ツール活用

### Git
- ブランチ戦略: Git Flow
- `main`: 安定版
- `develop`: 開発版
- `feature/*`: 機能開発
- `hotfix/*`: 緊急修正

### Unity
- Play Mode テストを活用
- Profilerで性能測定
- Console Logをクリアに保つ

## 品質チェックリスト

### コミット前
- [ ] コンパイルエラーなし
- [ ] 警告を確認
- [ ] テスト実行
- [ ] コード整形
- [ ] 不要なコメント削除

### リリース前
- [ ] すべてのテスト合格
- [ ] パフォーマンス測定
- [ ] ドキュメント更新
- [ ] 変更履歴記載
- [ ] タグ付け

## トラブルシューティング

### よくある問題と解決策

1. **名前空間の競合**
   - 完全修飾名を使用
   - using エイリアスを活用

2. **循環参照**
   - インターフェースで分離
   - イベントシステム活用

3. **メモリリーク**
   - イベント購読解除
   - リソース明示的解放

4. **パフォーマンス低下**
   - Profilerで原因特定
   - オブジェクトプール活用
   - LODシステム実装
